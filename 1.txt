when malformed FROM header injected, DMARC failed and spam messages went through. 
example of FROM headers:
from: user@example.com <user@example.com>

For normal processing, address listed in first part of header is used etc filters/spf "user@example.com"

Repro:
- Enable SPF and DMARC
- configure an incoming policy with Sender as @example.com
- injection a message with "FROM" header 
Mail From: user@test.com
rcpt to: user@example.com

from: user@example.com <user@example.com>
To: user1@example.com
subject: test


Results:

SPF check performed on "user@example.com" 
DMARC: no domain found
Or
Trace verdict: 
Result of DMARC Verification processing: 	DMARC verification not performed 
Expected:
DMARC: should